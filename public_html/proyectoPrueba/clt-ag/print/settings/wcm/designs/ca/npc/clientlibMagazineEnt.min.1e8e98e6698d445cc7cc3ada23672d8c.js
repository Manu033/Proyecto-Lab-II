if(typeof global_magPushActu_wcmMode!=="undefined"&&global_magPushActu_wcmMode!=="PREVIEW"&&global_magPushActu_wcmMode!=="EDIT"){var genererGrille=function(){var gridSelector=".magHome-grid";var gridSizerClass="magHome-gridSizer";var gridItemClass="magHome-gridItem";var gridItemSelector="."+gridItemClass;var gridItemClassSquare=gridItemClass+"--square";var gridItemClassLandscape=gridItemClass+"--landscape";var gridItemClassPortrait=gridItemClass+"--portrait";$(gridSelector).each(function(i){var $grid=
$(this);enquire.register(CommonNPC.medias.mqSmMin,{match:function(){var currentWidth=0;var layoutIfNeeded=function(){var newWidth=$grid.width();if(currentWidth!==newWidth){var nbCols=Math.round(newWidth/$grid.find("."+gridSizerClass).outerWidth());var sizerWidth=newWidth/nbCols;var sizerHeight=parseInt(sizerWidth);$grid.find(gridItemSelector).each(function(){var $item=$(this);if($item.hasClass(gridItemClassSquare)||$item.hasClass(gridItemClassLandscape))$item.width(sizerWidth*2);else $item.width(sizerWidth);
if($item.hasClass(gridItemClassSquare)||$item.hasClass(gridItemClassPortrait))$item.height(sizerHeight*2);else $item.height(sizerHeight)});$grid.packery("layout")}};$grid.remove("."+gridSizerClass).prepend('\x3cdiv class\x3d"'+gridSizerClass+'" /\x3e').packery({itemSelector:gridItemSelector,percentPosition:true,transitionDuration:0,resize:false,initLayout:false});$(window).off("load.magHomeGrid debounced-resize.magHomeGrid"+i).on("load.magHomeGrid debounced-resize.magHomeGrid"+i,layoutIfNeeded);layoutIfNeeded()},
unmatch:function(){$grid.packery("destroy").remove("."+gridSizerClass);$grid.find(gridItemSelector).width("").height("");$(window).off("load.magHomeGrid debounced-resize.magHomeGrid"+i)}})})};$(genererGrille)}
$(document).ready(function(){var nomSessionStorage="itemFocus";var nomAttr="id";var listeLiens=$(".js-focus-filtre .js-item-filtre");var i=0;listeLiens.each(function(){$(this).attr("id",i++)});var active=sessionStorage.getItem(nomSessionStorage);if(active){var lienActif=$(".js-focus-filtre a["+nomAttr+"\x3d"+active+"]");lienActif.focus();sessionStorage.removeItem(nomSessionStorage)}listeLiens.click(function(e){var id=$(this).attr(nomAttr);if(!sessionStorage.getItem(nomSessionStorage)||sessionStorage.getItem(nomSessionStorage)!=
id){e.preventDefault();sessionStorage.setItem(nomSessionStorage,id);$(this)[0].click()}});var listeVignette=$(".js-focus-vignette");listeVignette.focus(function(){if(listeVignette.children(".js-layer-vignette").css("visibility","hidden")&&listeVignette.children(".js-layer-vignette").css("opacity","0"))$(this).children(".js-layer-vignette").css("visibility","visible")&&$(this).children(".js-layer-vignette").css("opacity","1")});listeVignette.mouseover(function(){$(this).children(".js-layer-vignette").css("visibility",
"visible");$(this).children(".js-layer-vignette").css("opacity","1")});listeVignette.mouseleave(function(){$(this).children(".js-layer-vignette").css("visibility","hidden");$(this).children(".js-layer-vignette").css("opacity","0")});$(".thematiques-filtre").click(function(){$(".js-focus-filtre").children().eq(0).focus()})});var pathSaved=null;var page=null;var modePublish=typeof global_magPushActu_wcmMode!=="undefined"&&global_magPushActu_wcmMode!=="PREVIEW"&&global_magPushActu_wcmMode!=="EDIT";
function genererPages(){$("a.Pagination-link").on("click",function(e){e.preventDefault();page=encodeURI($(this).text());if(page==="%3C")page=parseInt(encodeURI($("span.Pagination-link--active").text()),10)-1;else if(page==="%3E")page=parseInt(encodeURI($("span.Pagination-link--active").text()),10)+1;selectionneParametresEnvoi(page,false);$(window).scrollTop(0)})}$(genererPages);
function changeUrlNav(url){window.document.location.href=url.replace("/_jcr_content/mag-grilleArticles","").replace("/jcr:content/mag-grilleArticles","")}
function selectionneParametresEnvoi(page,modeMobile){if(pathSaved==null&&magNavigation_Chemin)if(magNavigation_Chemin.indexOf("jcr:content")!=-1)pathSaved=magNavigation_Chemin;else{var path=magNavigation_Chemin.replace(".html","");pathSaved=path.concat("/jcr:content/mag-grilleArticles.html")}if(modePublish&&$("a.cardMagFilter-item--active").length>0){if(modeMobile)var pathPage=pathSaved.concat("?page\x3d",page,"\x26modeMobile\x3dtrue");else var pathPage=pathSaved.concat("?page\x3d",page);var thematique;
var rubrique;var typologie;$("a.cardMagFilter-item--active").each(function(){if($(this).attr("id")=="typologie"){var element=$("a.cardMagFilter-item--active").filter(function(){if($(this).attr("id")=="typologie")return $(this)});typologie=encodeURIComponent(element.text().replace("#",""))}if($(this).parent().parent().attr("id")=="themes"){var element=$("a.cardMagFilter-item--active").filter(function(){if($(this).parent().parent().attr("id")=="themes")return $(this)});thematique=encodeURIComponent(element.text().replace("#",
""))}if($(this).parent().parent().attr("id")=="categories"){var element=$("a.cardMagFilter-item--active").filter(function(){if($(this).parent().parent().attr("id")=="categories")return $(this)});rubrique=encodeURIComponent(element.text())}});var pathAttributes=pathPage;if(thematique&&rubrique)pathAttributes=pathPage.concat("\x26thematique\x3d",thematique,"\x26rubrique\x3d",rubrique);else if(thematique)pathAttributes=pathPage.concat("\x26thematique\x3d",thematique);else if(typologie)pathAttributes=
pathPage.concat("\x26typologie\x3d",typologie);else if(rubrique)pathAttributes=pathPage.concat("\x26rubrique\x3d",rubrique);$("#grilleArticle").parent().parent().load(pathAttributes,function(){+changeUrlNav(pathAttributes);genererGrille();genererFiltres();genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}else{if(modeMobile)var pathPage=pathSaved.concat("?page\x3d",page,"\x26modeMobile\x3dtrue");else var pathPage=pathSaved.concat("?page\x3d",page);$("#grilleArticle").parent().parent().load(pathPage,
function(){changeUrlNav(pathPage);if(modePublish){genererGrille();genererFiltres()}genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}}function genereAfficherPlus(){$(".PaginationMobile").on("click",function(e){e.preventDefault();page=parseInt(encodeURI($("span.Pagination-link--active").text()),10)+1;selectionneParametresEnvoi(page,true)})}$(genereAfficherPlus);var magNavigation_CheminSaved=null;
if(typeof global_magPushActu_wcmMode!=="undefined"&&global_magPushActu_wcmMode!=="PREVIEW"&&global_magPushActu_wcmMode!=="EDIT"){var genererFiltres$0=function(){$(".cardMagFilter-item").click(function(e){if(magNavigation_CheminSaved==null&&magNavigation_Chemin)if(magNavigation_Chemin.indexOf("jcr:content")!=-1)magNavigation_CheminSaved=magNavigation_Chemin;else{magNavigation_CheminSaved=magNavigation_Chemin.replace(".html","");magNavigation_CheminSaved=magNavigation_CheminSaved.concat("/jcr:content/mag-grilleArticles.html")}e.preventDefault();
$(this).trigger("loadNewContent");var classeTheme="cardMagFilter-filtersTab--themes";var classeRubrique="cardMagFilter-filtersTab--categories";var myClass=this.className;if(myClass.indexOf("cardMagFilter-item--disabled")>=0)e.preventDefault();else if(myClass.indexOf("cardMagFilter-item--active")>=0)if($(".cardMagFilter-item--active").size()==2){var theme=$(".cardMagFilter-filtersTab--themes .cardMagFilter-item--active").text().substr(1);theme=encodeURIComponent(theme);var rubrique=encodeURIComponent($(".cardMagFilter-filtersTab--categories .cardMagFilter-item--active").text());
if($(e.target).parent().parent().hasClass(classeTheme)){var cheminFinal=magNavigation_CheminSaved.concat("?rubrique\x3d",rubrique);$("#grilleArticle").parent().parent().load(cheminFinal,function(){changeUrlNav(cheminFinal);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}else if($(e.target).parent().parent().hasClass(classeRubrique)){var cheminFinal=magNavigation_CheminSaved.concat("?thematique\x3d",theme);$("#grilleArticle").parent().parent().load(cheminFinal,
function(){changeUrlNav(cheminFinal);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}}else $("#grilleArticle").parent().parent().load(magNavigation_CheminSaved,function(){changeUrlNav(magNavigation_CheminSaved);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)});else if($(e.target).parent().parent().hasClass(classeTheme)){var thematique=encodeURIComponent($(this).attr("data-filtre"));var cheminFinal=magNavigation_CheminSaved.concat("?thematique\x3d",
thematique);if($("a.cardMagFilter-item--active").size()>0&&$("a.cardMagFilter-item--active").attr("id")=="typologie")$("#grilleArticle").parent().parent().load(magNavigation_CheminSaved,function(){changeUrlNav(cheminFinal);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)});else if($("a.cardMagFilter-item--active").size()>0&&$("a.cardMagFilter-item--active").parent().parent().attr("id")=="categories"){var rubrique=encodeURIComponent($("a.cardMagFilter-item--active").text());
var cheminFinalRubriqueThematique=cheminFinal.concat("\x26rubrique\x3d",rubrique);$("#grilleArticle").parent().parent().load(cheminFinalRubriqueThematique,function(){changeUrlNav(cheminFinalRubriqueThematique);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}else $("#grilleArticle").parent().parent().load(cheminFinal,function(){changeUrlNav(cheminFinal);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}else if($(e.target).parent().parent().hasClass(classeRubrique)){var rubrique=
encodeURIComponent($(this).attr("data-filtre"));var cheminFinal=magNavigation_CheminSaved.concat("?rubrique\x3d",rubrique);if($("a.cardMagFilter-item--active").size()>0&&$("a.cardMagFilter-item--active").parent().parent().attr("id")=="themes"){var thematique=encodeURIComponent($("a.cardMagFilter-item--active")[0].innerText.replace("#",""));var cheminFinalRubriqueThematique=cheminFinal.concat("\x26thematique\x3d",thematique);$("#grilleArticle").parent().parent().load(cheminFinalRubriqueThematique,
function(){changeUrlNav(cheminFinalRubriqueThematique);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}else $("#grilleArticle").parent().parent().load(cheminFinal,function(){changeUrlNav(cheminFinal);genererGrille();genererFiltres$0();genererPages();genereAfficherPlus();cardMagFilterGenerate($)})}})};$(genererFiltres$0)}
$(document).ready(function(){$("a.Themes-tag").on("click",function(e){e.preventDefault();var tag=encodeURIComponent($(this).text().split("#")[1]);var category=$(this).hasClass("mag-typologie")?"typologie":"thematique";var newUrl=creerPathLien();newUrl+="?"+category+"\x3d"+tag;window.location.href=newUrl});$("a.ArticleDetail-sectionRubriqueLink").on("click",function(e){e.preventDefault();var rubrique=encodeURI($(this).text());var newUrl=creerPathLien();newUrl+="?rubrique\x3d"+rubrique;window.location.href=
newUrl});$("a.ArticleDetail-iconFolderLink").on("click",function(e){e.preventDefault();var typologie=encodeURI($(this).attr("title"));var newUrl=creerPathLien();newUrl+="?typologie\x3d"+typologie;window.location.href=newUrl});$("a.ArticleDetail-goBackMagTitle").on("click",function(e){e.preventDefault();var newUrl=creerPathLien();window.location.href=newUrl})});
function creerPathLien(){var currentUrl=window.location.href;var currentUrlTb=currentUrl.split("/");var newUrl="";for(var i=0;i<currentUrlTb.length-1;i++)if(i!=0)newUrl+="/"+currentUrlTb[i];else newUrl+=currentUrlTb[i];return newUrl+=".html"}
$(".CheckList").each(function(){var $checklist=$(this);var $steps=$checklist.find(".CheckList-step");var $viewport=$checklist.find(".CheckList-viewport");var itemsViewed=3;var currentIndex=0;var currentHeight=0;var maxIndex=$steps.length-itemsViewed-1;var setSteps=function(index){var currentScroll=0;if(index>maxIndex)index=maxIndex;else if(index<0)index=0;$checklist.find(".CheckList-footerLink--up").toggleClass("CheckList-footerLink--disabled",index===0);$checklist.find(".CheckList-footerLink--down").toggleClass("CheckList-footerLink--disabled",
index===maxIndex);$steps.each(function(i){var $step=$(this);if(i>=index&&i<index+itemsViewed)$step.removeClass("CheckList-step--disabled");else{if(i<index)currentScroll+=$step.outerHeight();$step.addClass("CheckList-step--disabled")}});$viewport.animate({scrollTop:currentScroll});currentIndex=index;return true};var setMaxHeight=function(){var allHeights=[];var maxHeight=0;$steps.each(function(){allHeights.push($(this).outerHeight())});for(var i=2;i<allHeights.length;i++){var currentHeightsSum=allHeights[i]+
allHeights[i-1]+allHeights[i-2];maxHeight=Math.max(maxHeight,currentHeightsSum)}$viewport.height(maxHeight);if(currentHeight!==maxHeight)$.fn.matchHeight._update(false);currentHeight=maxHeight};$checklist.off("click.CheckList.down",".CheckList-footerLink--down").on("click.CheckList.down",".CheckList-footerLink--down",function(e){e.preventDefault();setSteps(currentIndex+3)}).off("click.CheckList.up",".CheckList-footerLink--up").on("click.CheckList.up",".CheckList-footerLink--up",function(e){e.preventDefault();
setSteps(currentIndex-3)}).off("click.CheckList.toggle",".CheckList-stepToggle").on("click.CheckList.toggle",".CheckList-stepToggle",function(e){e.preventDefault();$(this).closest(".CheckList-step").toggleClass("CheckList-step--active");setMaxHeight()});$(window).off("debounced-resize.CheckList").on("debounced-resize.CheckList",function(){setMaxHeight();setSteps(currentIndex)});setSteps(currentIndex);$checklist.addClass("CheckList--init");setMaxHeight()});
function cardMagFilterGenerate(){var $cardFilter=$(".js-cardMagFilter");if($cardFilter.length){var STICKY_CLASS="cardMagFilter--sticky";var POPIN_CLASS="cardMagFilter--open";enquire.register(CommonNPC.medias.mqMdMin,{setup:function(){this.$scrollable=$(window)},match:function(){var stickyOffsetTop=500;var sticky=false;var $anchor=$(".js-cardMagFilter--height");var $scrollable=this.$scrollable;var updateVars=function(){if($anchor.length===0)stickyOffsetTop=$cardFilter.offset().top+$cardFilter.outerHeight()-
60;else stickyOffsetTop=$anchor.offset().top+$anchor.height()-60};var checkSticky=function(){var bandeauAlertHeight=$(".bandeau_alertes").children().length>1?$($(".bandeau_alertes").children()[1]).outerHeight(true):0;var needSticky=$scrollable.scrollTop()>stickyOffsetTop;if(sticky!==needSticky){if($anchor.length!==0){var $parent=$cardFilter.parent();$parent.css("height",needSticky===false?"":$parent.outerHeight())}$cardFilter.find("\x3e:first-child").css("margin-top",needSticky?bandeauAlertHeight:
0);$cardFilter.toggleClass(STICKY_CLASS,needSticky);sticky=needSticky}};var update=function(){updateVars();checkSticky()};if($anchor.length===0)$cardFilter.on("layoutUpdated.magHomeGrid.sticky",update);else $scrollable.on("debounced-resize.magHomeGrid.sticky",update);$scrollable.on("throttled-scroll.cardMagFilter.sticky",checkSticky);update()},unmatch:function(){$cardFilter.removeClass(STICKY_CLASS);$cardFilter.off("layoutUpdated.magHomeGrid.sticky");this.$scrollable.off("throttled-scroll.cardMagFilter.sticky debounced-resize.magHomeGrid.sticky")}});
enquire.register(CommonNPC.medias.mqSmMax,{match:function(){var $bodyHtml=$("body,html");var currentScroll=0;var openPopin=function(e){e.preventDefault();$cardFilter.addClass(POPIN_CLASS);currentScroll=$bodyHtml.scrollTop();$bodyHtml.addClass("is-overflowHidden");$cardFilter.on("click.magHomeGrid.popinTap",".js-cardMagFilter-filtersNavTabLink",function(e){e.preventDefault();var $link=$(this);var $li=$link.closest(".js-cardMagFilter-filtersNavTab");if(!$li.hasClass("cardMagFilter-filtersNavTab--active")){$li.addClass("cardMagFilter-filtersNavTab--active").siblings(".cardMagFilter-filtersNavTab--active").removeClass("cardMagFilter-filtersNavTab--active");
$($link.attr("href")).addClass("cardMagFilter-filtersTab--active").siblings(".cardMagFilter-filtersTab--active").removeClass("cardMagFilter-filtersTab--active")}})};var closePopin=function(e){e.preventDefault();$cardFilter.removeClass(POPIN_CLASS);$bodyHtml.scrollTop(currentScroll);$bodyHtml.removeClass("is-overflowHidden");$cardFilter.off("click.magHomeGrid.popinTap",".js-cardMagFilter-filtersNavTabLink")};$cardFilter.on("click.magHomeGrid.popin",".js-cardMagFilter-showFilters",openPopin);$cardFilter.on("click.magHomeGrid.popin",
".js-cardMagFilter-hideFilters",closePopin)},unmatch:function(){$cardFilter.off("click.magHomeGrid.popin",".js-cardMagFilter-showFilters");$cardFilter.off("click.magHomeGrid.popin",".js-cardMagFilter-hideFilters");$cardFilter.off("click.magHomeGrid.popinTap",".js-cardMagFilter-filtersNavTabLink")}});var $header=$(".js-Header");var heightHeader=0;var $visibleHeader=$header.filter(":visible");if($visibleHeader.length!==0)heightHeader=$visibleHeader.outerHeight(true);else{$header.show();heightHeader=
$header.outerHeight(true);$header.css("display","")}$(".Template").css("margin-top",heightHeader);$(window).trigger("scroll.bs.scrollspy").trigger("marginChanged.template")}}$(cardMagFilterGenerate);
(function($){$("div[ca-video-player] .magpv-arrow").click(function(){var videoProvider=$(this).parent().data("video-provider");var videoId=$(this).parent().data("video-id");if(videoId&&videoProvider=="YOUTUBE")$(this).parent().html('\x3ciframe type\x3d"text/html" width\x3d"640" height\x3d"360" src\x3d"http://www.youtube.com/embed/'+videoId+'?autoplay\x3d1\x26origin\x3dhttp://www.credit-agricole.fr" frameborder\x3d"0"/\x3e')})})(jQuery);
$(document).ready(function(){var contenuBaliseH1=$("div.cardMagFilter-main \x3e h1 \x3e div").text().trim();if(contenuBaliseH1==""||contenuBaliseH1.length==0)$("div.cardMagFilter-main \x3e h1").remove()});