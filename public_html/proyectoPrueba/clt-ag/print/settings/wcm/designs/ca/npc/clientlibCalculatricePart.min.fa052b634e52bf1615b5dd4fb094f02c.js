$(function(){var DECIMAL_AMOUNT=2;var CALCULATOR_GRAPH_EMPTY_CLASS="CalculatorResult-graph--empty";var CALCULATOR_GRAPH_OVER_CLASS="CalculatorResult-graph--over";var CALCULATOR_RESULTS_VERTICAL_CLASS="CalculatorResult-results--vertical";var CALCULATOR_RESULTS_SHOW_CLASS="Calculator--showResult";var CALCULATOR_SELECTOR=".js-Calculator";var CALCULATOR_INCOME_SELECTOR=".js-Calculator-income";var CALCULATOR_SPENDING_SELECTOR=".js-Calculator-spending";var CALCULATOR_VALUE_SELECTOR=".js-Calculator-value";
var CALCULATOR_TYPE_SELECTOR="select.js-Calculator-type";var CALCULATOR_GRAPH_VALUE_SELECTOR=".js-CalculatorResult-graphValue";var CALCULATOR_GRAPH_PROGRESS_SELECTOR=".js-CalculatorResult-graphProgressInner";var CALCULATOR_GRAPH_INCOME_SELECTOR=".js-CalculatorResult-graph--income";var CALCULATOR_GRAPH_SPENDING_SELECTOR=".js-CalculatorResult-graph--spending";var CALCULATOR_RESULTS_SELECTOR=".js-CalculatorResult-results";var CALCULATOR_RESULT_MONTH_SELECTOR=".js-CalculatorResult-resultValue--month";
var CALCULATOR_RESULT_YEAR_SELECTOR=".js-CalculatorResult-resultValue--year";var CALCULATOR_SHOW_RESULT_SELECTOR=".js-Calculator-showResult";var CALCULATOR_HIDE_RESULT_SELECTOR=".js-Calculator-hideResult";var currentIncome=0;var currentSpending=0;var $calculator=$(CALCULATOR_SELECTOR);var $incomes=$calculator.find(CALCULATOR_INCOME_SELECTOR);var $spendings=$calculator.find(CALCULATOR_SPENDING_SELECTOR);var $graphIncome=$calculator.find(CALCULATOR_GRAPH_INCOME_SELECTOR);var $graphSpending=$calculator.find(CALCULATOR_GRAPH_SPENDING_SELECTOR);
var $results=$calculator.find(CALCULATOR_RESULTS_SELECTOR);var $resultMonth=$calculator.find(CALCULATOR_RESULT_MONTH_SELECTOR);var $resultYear=$calculator.find(CALCULATOR_RESULT_YEAR_SELECTOR);var $showResults=$calculator.find(CALCULATOR_SHOW_RESULT_SELECTOR);var $hideResults=$calculator.find(CALCULATOR_HIDE_RESULT_SELECTOR);$(".Calculator-itemInput").focusout(function(){var montant=$(this).val();if(!verifierMontant(montant)&&montant!==""){$(this).parent().parent().addClass("has-error");$(this).parent().parent().children().last().show()}else{if(montant!==
"")montant=parseFloat(montant).toFixed(2);$(this).val(montant);$(this).parent().parent().removeClass("has-error");$(this).parent().parent().children().last().hide()}});$(".Calculator-sectionAction").on("click",function(e){e.preventDefault();$spendings.find(CALCULATOR_VALUE_SELECTOR).val("");$(".form-group").removeClass("has-error");$(".help-block").hide();checkSpending()});function verifierMontant(montant){var montantCorrectFormat=/^\+?[0-9]*\.?[0-9]+$/;var isCorrect=montantCorrectFormat.test(montant);
return isCorrect}function pretifyValue(value){return value.toLocaleString()}function setGraphValue($graph,value,max){var percent=100;if(max===undefined)max=currentIncome;if(max!==false&&max!==0)percent=value/max*100;$graph.toggleClass(CALCULATOR_GRAPH_EMPTY_CLASS,value===0);$graph.toggleClass(CALCULATOR_GRAPH_OVER_CLASS,max!==false&&value>max);$graph.find(CALCULATOR_GRAPH_VALUE_SELECTOR).html(pretifyValue(value));$graph.find(CALCULATOR_GRAPH_PROGRESS_SELECTOR).width(percent+"%");$resultMonth.html(pretifyValue(currentIncome-
currentSpending));$resultYear.html(pretifyValue((currentIncome-currentSpending)*12));$resultYear.attr("data-tracking-simulation_resultat_solde",(currentIncome-currentSpending)*12);toggleResultsVertical()}function toggleResultsVertical(){$results.removeClass(CALCULATOR_RESULTS_VERTICAL_CLASS);setTimeout(function(){if($resultMonth.offset().top!==$resultYear.offset().top)$results.addClass(CALCULATOR_RESULTS_VERTICAL_CLASS)},10)}function getAmountValue($item){var val=parseFloat($item.find(CALCULATOR_VALUE_SELECTOR).val().replace(/ /g,
"").replace(/,/g,"."));if(isNaN(val))val=0;var type=$item.find(CALCULATOR_TYPE_SELECTOR).val();if(type==="2")val=val/12;val=Math.round(val*Math.pow(10,DECIMAL_AMOUNT))/Math.pow(10,DECIMAL_AMOUNT);return val}function checkIncome(){currentIncome=0;$incomes.each(function(){currentIncome+=getAmountValue($(this))});checkSpending(false);setGraphValue($graphIncome,currentIncome,currentIncome<currentSpending?currentSpending:false)}function checkSpending(checkIncome){currentSpending=0;$spendings.each(function(){currentSpending+=
getAmountValue($(this))});setGraphValue($graphSpending,currentSpending,currentIncome);if(checkIncome!==false)setGraphValue($graphIncome,currentIncome,currentIncome<currentSpending?currentSpending:false)}function checkIncomeItem(){checkIncome.call($(this).closest($incomes)[0])}function checkSpendingItem(){checkIncome.call($(this).closest($incomes)[0])}enquire.register(CommonNPC.medias.mqMdMin,{match:function(){$incomes.on("change.calculator",CALCULATOR_VALUE_SELECTOR,checkIncomeItem).on("change.calculator",
CALCULATOR_TYPE_SELECTOR,checkIncomeItem);$spendings.on("change.calculator",CALCULATOR_VALUE_SELECTOR,checkSpendingItem).on("change.calculator",CALCULATOR_TYPE_SELECTOR,checkSpendingItem);$(window).on("debounced-resize.calculator",toggleResultsVertical);checkIncome()},unmatch:function(){$incomes.off("change.calculator",CALCULATOR_VALUE_SELECTOR).off("change.calculator",CALCULATOR_TYPE_SELECTOR);$spendings.off("change.calculator",CALCULATOR_VALUE_SELECTOR).off("change.calculator",CALCULATOR_TYPE_SELECTOR);
$(window).off("debounced-resize.calculator")}});enquire.register(CommonNPC.medias.mqSmMax,{match:function(){$showResults.on("click.calculator",function(e){e.preventDefault();$calculator.addClass(CALCULATOR_RESULTS_SHOW_CLASS);checkIncome();$("body,html").scrollTop($calculator.offset().top-$(".js-HeaderSticky,.js-Header").filter(":visible").height());$(window).on("debounced-resize.calculator",toggleResultsVertical)});$hideResults.on("click.calculator",function(e){e.preventDefault();$calculator.removeClass(CALCULATOR_RESULTS_SHOW_CLASS);
$("body,html").scrollTop($calculator.offset().top-$(".js-HeaderSticky,.js-Header").filter(":visible").height());$(window).off("debounced-resize.calculator")})},unmatch:function(){$calculator.removeClass(CALCULATOR_RESULTS_SHOW_CLASS);$showResults.off("click.calculator");$hideResults.off("click.calculator");$(window).off("debounced-resize.calculator")}})});